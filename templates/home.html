{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualize</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Zeyada&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <style>
        /* Additional styles for light and dark modes */
        body.light-mode {
            --bg-color: #f8f9fa;
            --text-color: #343a40;
            --card-bg: #ffffff;
            --card-shadow: rgba(0, 0, 0, 0.1);
            --h1-color: #343a40;
            --h2-color: #0d6efd;
        }

        body.dark-mode {
            --bg-color: #343a40;
            --text-color: #f8f9fa;
            --card-bg: #495057;
            --card-shadow: rgba(0, 0, 0, 0.5);
            --h1-color: #f8f9fa;
            --h2-color: orange;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
        }

        .card-body {
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0px 4px 8px var(--card-shadow);
            padding: 20px;
            margin-bottom: 20px;
        }

        h1 {
            text-align: center;
            margin-top: 20px;
            font-family: 'Dancing Script', cursive;
            font-size: 60px;
            font-weight: 50px;
            color: var(--h1-color);
        }

        h2 {
            text-align: center;
            margin-top: 20px;
            font-family: 'Pacifico', cursive;
            font-size: 30px;
            color: var(--h2-color);
        }

        .container {
            margin: 20px auto;
            max-width: 1200px;
        }

        .list-group {
            margin-top: 20px;
        }

        .list-group-item {
            cursor: pointer;
            font-size: 18px;
            padding: 15px;
            border: none;
        }

        .list-group-item:hover {
            background-color: #007bff;
            color: #ffffff;
        }

        .list-group-item:focus {
            background-color: #007bff;
            color: #ffffff;
        }

        .form-label {
            font-weight: bold;
        }

        .form-select {
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ced4da;
            font-size: 16px;
        }

        .btn-primary, .btn-secondary {
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
        }

        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
        }

        .btn-primary:hover {
            background-color: #0056b3;
            border-color: #0056b3;
        }

        .btn-secondary {
            background-color: #6c757d;
            border-color: #6c757d;
        }

        .btn-secondary:hover {
            background-color: #5a6268;
            border-color: #5a6268;
        }

        .text-danger {
            color: #dc3545;
            font-weight: bold;
            margin-top: 20px;
        }

        img {
            width: 100%;
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-top: 20px;
        }
    </style>
</head>
<body class="light-mode">
    <div class="container">
        <button id="theme-toggle" class="btn btn-secondary">Toggle Dark Mode</button>
        
        <h1>Visualize Data</h1>
        <div class="row">
            <div class="col-md-3">
                <!-- Menu Bar -->
                <div class="list-group">
                    <button class="list-group-item list-group-item-action" onclick="showSection('single-material')">Single Material Plot</button>
                    <button class="list-group-item list-group-item-action" onclick="showSection('compare-materials')">Compare Materials</button>
                    <button class="list-group-item list-group-item-action" onclick="showSection('compare-months')">Compare Months</button>
                </div>
            </div>
            <div class="col-md-9">
                <!-- Single Material Plot Section -->
                <div id="single-material" class="content-section">
                    <div class="card card-body">
                        <h2>Single Material Plot</h2>
                        <form action="{% url 'home' %}" method="POST">
                            {% csrf_token %}
                            <input type="hidden" name="section" value="single-material">
                            <label for="material" class="form-label">Select Material:</label>
                            <div class="col-md-4">
                            <select id="material" name="colname1" class="form-select">
                                {% for material in materials %}
                                <option value="{{ material }}">{{ material }}</option>
                                {% endfor %}
                            </select>
                            </div>
                            <input type="submit" value="Plot" class="btn btn-primary mt-3">
                        </form>
                        {% if image_url and not material2 and not month2 %}
                        <h2>Plot:</h2>
                        <img src="{{ image_url }}" alt="Plot Image">
                        {% endif %}
                    </div>
                </div>

                <!-- Compare Materials Section -->
                <div id="compare-materials" class="content-section" style="display: none;">
                    <div class="card card-body">
                        <h2>Compare Materials</h2>
                        <form action="{% url 'home2' %}" method="POST">
                            {% csrf_token %}
                            <input type="hidden" name="section" value="compare-materials">
                            <div class="row">
                                <div class="col">
                                    <label for="material1" class="form-label">Select Material 1:</label>
                                    <select id="material1" name="colname1" class="form-select">
                                        {% for material in materials %}
                                        <option value="{{ material }}">{{ material }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col">
                                    <label for="material2" class="form-label">Select Material 2:</label>
                                    <select id="material2" name="colname2" class="form-select">
                                        {% for material in materials %}
                                        <option value="{{ material }}">{{ material }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <input type="submit" value="Compare" class="btn btn-primary mt-3">
                        </form>
                        {% if image_url and material2 %}
                        <h2>Comparison Plot:</h2>
                        <img src="{{ image_url }}" alt="Comparison Plot Image">
                        {% endif %}
                    </div>
                </div>

                <!-- Compare Months Section -->
                <div id="compare-months" class="content-section" style="display: none;">
                    <div class="card card-body">
                        <h2>Compare Months</h2>
                        <form action="{% url 'home3' %}" method="POST">
                            {% csrf_token %}
                            <input type="hidden" name="section" value="compare-months">
                            <div class="row">
                                <div class="col">
                                    <label for="month1" class="form-label">Select Month 1:</label>
                                    <select id="month1" name="monthname1" class="form-select">
                                        {% for month in months %}
                                        <option value="{{ month|lower }}">{{ month }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col">
                                    <label for="month2" class="form-label">Select Month 2:</label>
                                    <select id="month2" name="monthname2" class="form-select">
                                        {% for month in months %}
                                        <option value="{{ month|lower }}">{{ month }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <input type="submit" value="Compare Months" class="btn btn-primary mt-3">
                        </form>
                        {% if image_url and month2 %}
                        <h2>Month Comparison Plot:</h2>
                        <img src="{{ image_url }}" alt="Month Comparison Plot Image">
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Function to display the correct section
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.style.display = 'none';
            });
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
                sessionStorage.setItem('activeSection', sectionId); // Store active section
            }
        }

        // On page load, display the section corresponding to the session storage value
        window.onload = function() {
            const storedSection = sessionStorage.getItem('activeSection');
            if (storedSection && document.getElementById(storedSection)) {
                showSection(storedSection);
            } else {
                showSection('single-material'); // Default section
            }

            // Handle theme toggle
            const toggleButton = document.getElementById('theme-toggle');
            const currentMode = localStorage.getItem('theme') || 'light-mode';
            document.body.classList.add(currentMode);
            toggleButton.addEventListener('click', () => {
                if (document.body.classList.contains('light-mode')) {
                    document.body.classList.replace('light-mode', 'dark-mode');
                    localStorage.setItem('theme', 'dark-mode');
                    toggleButton.textContent = 'Toggle Light Mode';
                } else {
                    document.body.classList.replace('dark-mode', 'light-mode');
                    localStorage.setItem('theme', 'light-mode');
                    toggleButton.textContent = 'Toggle Dark Mode';
                }
            });
        };
    </script>
</body>
</html>
